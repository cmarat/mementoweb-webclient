@(msb: uk.bl.wap.memento.jsf.MementoBackingBean)
<html>
    <head>
        <title>BlueBox - @msb.getUrl()</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
	    <meta name="description" content="UK Web Archive - BlueBox"/>
    	<meta name="author" content="www.webarchive.org.uk"/>

        <link rel="stylesheet" media="screen" href="@routes.Assets.at("stylesheets/main.css")">
        <link rel="stylesheet" media="screen" href="@routes.Assets.at("stylesheets/jquery.dataTables.css")">
        <link rel="stylesheet" media="screen" href="@routes.Assets.at("bootstrap/css/bootstrap.css")">
        <link rel="stylesheet" media="screen" href="@routes.Assets.at("nvd3/src/nv.d3.css")">
        <link rel="shortcut icon" type="image/png" href="@routes.Assets.at("images/favicon.png")">
        <script src="@routes.Assets.at("javascripts/jquery-1.7.1.min.js")" type="text/javascript"></script>
        <script src="@routes.Assets.at("javascripts/jquery.dataTables.min.js")" type="text/javascript"></script>
        <script src="@routes.Assets.at("nvd3/lib/d3.v2.min.js")" type="text/javascript"></script>
        <script src="@routes.Assets.at("nvd3/nv.d3.min.js")" type="text/javascript"></script>
        <script src="@routes.Assets.at("bootstrap/js/bootstrap.min.js")" type="text/javascript"></script>
    </head>
    <body>

     <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="http://www.webarchive.org.uk/"><img src="@routes.Assets.at("/images/ukwa-icon-nobg-16.png")"/>UK Web Archive</a>
          <div class="nav-collapse">
            <ul class="nav">
              <li><a href="http://www.webarchive.org.uk/">Home</a></li>
              <li class="active"><a href="#{mementoBackingBean.absoluteUrl}/">BlueBox</a></li>
              <li><a href="https://github.com/ukwa/">GitHub</a></li>
            </ul>
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>
    
    <div class="container">

      <!-- Example row of columns -->
      <div class="row first-row">
    
      <form id="searchForm">
       <div columns="1" style="margin: 0 auto;">
        <div columns="2" border="0">
          <h:graphicImage value="images/mementologo.png" />
          <div columns="1" border="0" style="text-align: center;">        
            <div>
            <label value="URL" for="url" rendered="false"/>
            <input type="text" id="url" value="@msb.getUrl()" size="80"></h:inputText>
            </div>
            <input type="submit" value="Engage The TimeGate..." action="#{mementoBackingBean.submit}" />
          </div>
        </div>
       </div>
      
      <div columns="1" style="margin: 0 auto;" rendered="#{mementoBackingBean.urlSet}">
      <h:messages style='list-style: none; margin-left: 0;' fatalClass='alert alert-error' errorClass="alert alert-error" infoClass='alert alert-info' warnClass="alert alert-warn"/>
      <div columns="2" style="margin: 0 auto;">
      <div>
      <p>
        This URL (<a href="@msb.getUrl()">@msb.getUrl()</a>) has been archived @msb.getTotalCount() times by @msb.getNumHosts() organisation(s) between @msb.getFirstMemento().getDateTime().getYear() and @msb.getLastMemento().getDateTime().getYear().
      </p>
      <p>
        Also available as&#160;<h:outputLink value="#{mementoBackingBean.absoluteUrl}/timegate/json?url=#{mementoBackingBean.url}">JSON</h:outputLink>.
      </p>
      <p>
        <a href="http://webcitation.org/archive?url=@msb.getUrl()">Click here to use WebCite&#153; to archive @msb.getUrl()</a>.
      </p>
      
    <p:dataTable id="summaryTable" var="h" value="#{mementoBackingBean.hosts}" 
    		sortBy="#{mementoBackingBean.hostCounts[h]}" sortOrder="descending">
    
        <p:column sortBy="#{h}">  
            <f:facet name="header">  
                <h:outputText value="Host Archive" />  
            </f:facet>
            <h:graphicImage value="images/favicons/#{h}/favicon.ico"/>&#160;<h:outputLink value="http://#{h}">#{h}</h:outputLink>
        </p:column>
        
        <p:column sortBy="#{mementoBackingBean.hostCounts[h]}">  
            <f:facet name="header">  
                <h:outputText value="Archived Versions" />  
            </f:facet>
            <h:outputText value="#{mementoBackingBean.hostCounts[h]}" />
        </p:column>
        
    </p:dataTable>
    </div>
    <div>
                
<svg id="test1"></svg>

<script> 

  var testdata = [ 
                  {
                	    key: "Archive Hosts",
                	    values: [
                       @Html(msb.getHostPieData())
                   ] } ];

nv.addGraph(function() {
    var width = 300,
        height = 300;

    var chart = nv.models.pieChart()
        .x(function(d) { return d.label })
        .y(function(d) { return d.value })
        .showLabels(false)
        .color(d3.scale.category10().range())
        .width(width)
        .height(height);
    
      chart.tooltipContent(
    		  function(key, y, e, graph) {
          		return '<p><img style="width: 16px; height: 16px;" src="#{mementoBackingBean.absoluteUrl}/images/favicons/'+key+'/favicon.ico"/>&#160;<b>' + key + '</b></p>' +
          		'<p>' +  e.value + ' snapshots</p>'
      });

      d3.select("#test1")
          .datum(testdata)
        .transition().duration(1200)
          .attr('width', width)
          .attr('height', height)
          .call(chart);

    return chart;
});

</script>
    
    </div>
    </div>
    
      <div>
      <h2>Archived Instances</h2>
    <table id="mementos_list">
        <thead>
            <th>Date &amp; Time</th>
            <th>Archival Host</th>
            <th>Link To Memento</th>
        </thead>
        <tbody>
        @for(m <- msb.getMementos()) {
            <tr>
                <td>@m.getDateTime()</td>
                <td>@m.getArchiveHost()</td>
                <td><a href="@m.getUrl()">@m.getRel()</a></td>
            </tr>
        }
        </tbody>
    </table>
    <script type="text/javascript" charset="utf-8">
    jQuery.extend( jQuery.fn.dataTableExt.oSort, {
    "date-euro-pre": function ( a ) {
        if ($.trim(a) != '') {
            var frDatea = $.trim(a).split(' ');
            var frTimea = frDatea[1].split(':');
            var frDatea2 = frDatea[0].split('/');
            var yr = parseInt(frDatea2[2]);
            if( yr > 50 ) frDatea2[2] = "19"+frDatea2[2];
            if( yr <= 50 ) frDatea2[2] = "20"+frDatea2[2];
            var x = parseInt(frDatea2[2] + frDatea2[1] + frDatea2[0] + frTimea[0] + frTimea[1]);
        } else {
            var x = 10000000000000; // = l'an 1000 ...
        }
         
        return x;
    },
 
    "date-euro-asc": function ( a, b ) {
        return a - b;
    },
 
    "date-euro-desc": function ( a, b ) {
        return b - a;
    }
    } );

            $(document).ready(function() {
                $('#mementos_list').dataTable( {
                    "aoColumns": [
                      { "sType": "date-euro" },
                      null,
                      null
                    ]
                } );
            } );
    </script>
    
    </div>
    
    </div>

      </form>
      
    <div columns="1" style="margin: 0 auto;">

    <div style="text-align: center;">
     <p>
      Bookmarklet:&#160;<h:outputLink value="javascript:void(location.href='#{mementoBackingBean.absoluteUrl}/search.jsf?url='+escape(location.href))">BlueBox</h:outputLink>
     </p>
     <p>
      For more information on Memento, see&#160;<h:outputLink value="http://www.mementoweb.org/">www.mementoweb.org</h:outputLink>.
     </p>
     <p>
     This web interface uses the Memento aggregate TimeGate hosted by&#160;<h:outputLink value="http://lanl.gov">lanl.gov</h:outputLink>.<br/>
     This interface was created by the&#160;<h:outputLink value="http://www.webarchive.org.uk/">UK Web Archive</h:outputLink>.<br/>
     The source code is&#160;<h:outputLink value="https://github.com/ukwa/mementoweb-webclient">hosted on GitHub</h:outputLink>.
     </p>
    </div>
    
    </div>
    
    </div>
    </div>
      
    </body>
</html>